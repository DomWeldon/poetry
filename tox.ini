[tox]
skipsdist = True
envlist = py27, py34, py35, py36, py37, lint

[testenv]
whitelist_externals = poetry
skip_install = true
commands =
    poetry install -vvv
    poetry run pytest tests/

[testenv:lint]
description = Format the code base to adhere to our styles, and complain about what we cannot do automatically
basepython = python3.7
extras = lint
deps = pre-commit >= 1.14.4, < 2
skip_install = True
commands = pre-commit run --all-files --show-diff-on-failure
           python -c 'import pathlib; print("hint: run \{\} install to add checks as pre-commit hook".format(pathlib.Path(r"{envdir}") / "bin" / "pre-commit"))'
